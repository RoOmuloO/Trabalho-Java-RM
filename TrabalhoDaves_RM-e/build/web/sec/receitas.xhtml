<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../WEB-INF/Template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    
    <ui:define name="content">
        <h2>Receitas</h2>
        <h:form id="form">
            <h:panelGroup id="lista" rendered="#{receitasBean.status == 'View'}" >
                <h:panelGroup rendered="#{loginBean.usuario.tipo == 4 or loginBean.usuario.tipo == 1}">
                <h:commandButton value="Nova Receita" action="#{receitasBean.novaReceita()}" id="novo" class="btn-success"/>
                </h:panelGroup>
                
                <h:dataTable value="#{receitasBean.receitas}" var="v"
                             border="1" style="width: 100%" class="table-bordered">   
                    <h:column>
                        <f:facet name="header">
                            Id
                        </f:facet>
                            ${v.idreceita}
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            Local Consulta
                        </f:facet>
                            ${v.consultaIdconsulta.local}
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            Medico
                        </f:facet>
                            ${v.consultaIdconsulta.usuarioMedico.nome}
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            Paciente
                        </f:facet>
                            ${v.consultaIdconsulta.usuarioPaciente.nome}
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            Usada
                        </f:facet>
                            ${v.usada}
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            Ações
                        </f:facet>
                        <h:commandLink value="Edit" class="editar"/>
                        &nbsp;
                        <h:commandLink value="Apagar" style="color: red;"/>
                    </h:column>
                    
                </h:dataTable>
            </h:panelGroup>

            <h:panelGroup id="Cadastro"  rendered="#{receitasBean.status == 'Cad'}">
                
                <h:panelGrid columns="2">
                    
                    Consulta: <h:selectOneListbox value="#{receitasBean.receita.consultaIdconsulta}">
                        <f:selectItems value="#{receitasBean.consultas}" var="m" itemLabel="#{m.usuarioPaciente.nome} - #{m.data}" itemValue="#{m.idconsulta}" />                        
                    </h:selectOneListbox>
                    
                    Medicamentos: <h:selectManyListbox value="#{receitasBean.receberMedicamentos}">
                        <f:selectItems value="#{receitasBean.medicamentos}" var="m" itemLabel="#{m.nome}" itemValue="#{m.idmedicamento}"/>                        
                    </h:selectManyListbox>
                    
                    Instruções de uso: <h:inputTextarea value="#{receitasBean.receita.instrucoesUso}" required="true" label="instrucoes" />
                    
                    <h:panelGroup />
                    <h:panelGroup style="float: right;">
                        <h:commandButton value="Gravar" action="#{receitasBean.gravarReceita()}" class="btn-success"/>
                    </h:panelGroup>   
                </h:panelGrid>
            </h:panelGroup>
        </h:form>
        <h:form   rendered="#{receitasBean.status == 'Cad'}" id="formVoltar">
            <h:commandButton value="Voltar" class="btn-danger" immediate="true" action="#{receitasBean.voltar()}"/>
        </h:form>
    </ui:define>

</ui:composition>

